{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "seconds"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        -1120,
        -144
      ],
      "id": "f400a472-5ef4-4632-af7c-520e5db606b0",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "url": "=https://api.telegram.org/bot8119771513:AAH_FnBRpQf7JUXIVP4jwCf4vq3cByd8K_M/getUpdates",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "offset",
              "value": "={{ $vars.telegramOffset || 0 }}"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -912,
        -144
      ],
      "id": "1382b602-50c2-483e-983a-0438f1a12970",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "b115accf-1de2-49c8-a037-98786d5077b6",
              "leftValue": "={{ $json['result'].length > 0 }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            },
            {
              "id": "c8694386-9eab-4f5a-a341-2980f46176a2",
              "leftValue": "={{ $json['result'][0].update_id > 0 }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -496,
        -144
      ],
      "id": "5be797ea-224d-4120-9f14-d7b0eb2ddb42",
      "name": "If"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ab010354-d991-4a82-8d1c-5da762bc9f2f",
              "name": "=N8N_TELEGRAM_LAST_UPDATE_ID",
              "value": "={{ $json['result'][0].update_id }}",
              "type": "string"
            },
            {
              "id": "e25ee29e-57a8-42e3-bc44-f4b52bd2af22",
              "name": "telegram_data",
              "value": "={{ $json }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        144,
        -128
      ],
      "id": "fcc49ba6-8cb7-4b9a-aac8-efbdd01b9dd8",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "dc9b78c6-c11b-44be-b4ad-f4fc273dce5c"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "051aaead-bede-48fe-a989-01cb6d35e49b",
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "video",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d3842144-bc32-412b-a276-a4f0a70cd8f2",
                    "leftValue": "{{ $json.contentType }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2c53dff7-01e8-48ac-b0bd-7ff5e4f50bac",
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "ce7ec8ba-2415-49b9-8f2c-3d51c4aaf026",
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "url",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        528,
        -112
      ],
      "id": "18bb48d5-6f19-418a-a174-464f31c7f5bf",
      "name": "Switch"
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ!",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1008,
        -768
      ],
      "id": "b8f143bb-3740-4105-a57f-820315c2bbee",
      "name": "Send a text message1",
      "webhookId": "322db8d2-aaea-468c-9b4a-839ca7699ad4",
      "credentials": {
        "telegramApi": {
          "id": "QzIF6bZyJDYUkwfr",
          "name": "Telegram account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ö–û–î –° –ü–†–ê–í–ò–õ–¨–ù–û–ô –û–ë–†–ê–ë–û–¢–ö–û–ô JSON –°–¢–†–û–ö–ò (–î–û–ü–û–õ–ù–ï–ù –î–õ–Ø VIDEO)\ntry {\n  console.log('=== –ù–ê–ß–ê–õ–û –û–ë–†–ê–ë–û–¢–ö–ò ===');\n  \n  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã\n  const allItems = $input.all();\n  console.log('–í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:', allItems.length);\n  \n  // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å telegram_data\n  let telegramDataString = null;\n  \n  for (const item of allItems) {\n    if (item.json && item.json.telegram_data) {\n      telegramDataString = item.json.telegram_data;\n      console.log('‚úÖ –ù–∞–π–¥–µ–Ω telegram_data (—Ç–∏–ø:', typeof telegramDataString, ')');\n      break;\n    }\n  }\n  \n  if (!telegramDataString) {\n    console.log('‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω telegram_data');\n    return [];\n  }\n  \n  // –ü–ê–†–°–ò–ú JSON —Å—Ç—Ä–æ–∫—É –≤ –æ–±—ä–µ–∫—Ç\n  let telegramData;\n  try {\n    telegramData = JSON.parse(telegramDataString);\n    console.log('‚úÖ JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω');\n  } catch (parseError) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError.message);\n    console.log('–°—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞:', telegramDataString.substring(0, 100) + '...');\n    return [];\n  }\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É\n  if (!telegramData.result || !Array.isArray(telegramData.result) || telegramData.result.length === 0) {\n    console.log('‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ result');\n    return [];\n  }\n  \n  const firstResult = telegramData.result[0];\n  \n  if (!firstResult.message) {\n    console.log('‚ùå –ù–µ—Ç message –≤ result[0]');\n    return [];\n  }\n  \n  const message = firstResult.message;\n  console.log('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç:', message.from.first_name);\n  \n  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –¥–∞–Ω–Ω—ã–µ\n  let contentType = 'text';\n  let contentData = '';\n  let isUrl = false;\n  let videoInfo = null;\n  \n  // –û–ë–†–ê–ë–û–¢–ö–ê –í–ò–î–ï–û\n  // –û–ë–†–ê–ë–û–¢–ö–ê –í–ò–î–ï–û\nif (message.video) {\n  contentType = 'video';\n  contentData = message.video.file_id; // file_id –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ getFile\n  \n  // ‚≠ê –°–û–•–†–ê–ù–Ø–ï–ú –í–°–ï ID –î–õ–Ø –†–ê–ë–û–¢–´ –° –í–ò–î–ï–û\n  videoInfo = {\n    // –û–°–ù–û–í–ù–´–ï ID –î–õ–Ø API TELEGRAM\n    fileId: message.video.file_id,           // –î–ª—è getFile –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è\n    fileUniqueId: message.video.file_unique_id, // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ñ–∞–π–ª–∞\n    thumbnailFileId: message.video.thumbnail?.file_id || null, // ID –ø—Ä–µ–≤—å—é\n    \n    // –ú–ï–¢–ê–î–ê–ù–ù–´–ï –í–ò–î–ï–û\n    duration: message.video.duration,\n    width: message.video.width,\n    height: message.video.height,\n    fileSize: message.video.file_size,\n    fileName: message.video.file_name || '',\n    mimeType: message.video.mime_type || 'video/mp4',\n    \n    // –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–†–ï–í–¨–Æ (thumbnail)\n    thumbnail: message.video.thumbnail ? {\n      fileId: message.video.thumbnail.file_id,\n      fileUniqueId: message.video.thumbnail.file_unique_id,\n      fileSize: message.video.thumbnail.file_size,\n      width: message.video.thumbnail.width,\n      height: message.video.thumbnail.height\n    } : null,\n    \n    // –ü–û–î–ü–ò–°–¨\n    caption: message.caption || '',\n    hasCaption: !!message.caption,\n    \n    // –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø\n    fileType: 'video',\n    canBeDownloaded: true,\n    \n    // –°–°–´–õ–ö–ò –î–õ–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –§–ê–ô–õ–ê (—Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è)\n    getFileUrl: `https://api.telegram.org/bot{BOT_TOKEN}/getFile?file_id=${message.video.file_id}`,\n    downloadUrl: `https://api.telegram.org/file/bot{BOT_TOKEN}/{file_path}`\n  };\n  \n  console.log('üé¨ –í–∏–¥–µ–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:');\n  console.log('   üìÅ File ID:', videoInfo.fileId.substring(0, 30) + '...');\n  console.log('   üÜî Unique ID:', videoInfo.fileUniqueId);\n  console.log('   üìè –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:', videoInfo.width + 'x' + videoInfo.height);\n  console.log('   ‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:', videoInfo.duration + '—Å–µ–∫');\n  console.log('   üíæ –†–∞–∑–º–µ—Ä:', videoInfo.fileSize ? \n    Math.round(videoInfo.fileSize / 1024 / 1024 * 100) / 100 + 'MB' : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ');\n  console.log('   üñºÔ∏è –ü—Ä–µ–≤—å—é:', videoInfo.thumbnail ? \n    `${videoInfo.thumbnail.width}x${videoInfo.thumbnail.height}` : '–Ω–µ—Ç');\n  console.log('   üìù –ü–æ–¥–ø–∏—Å—å:', videoInfo.caption || '(–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∏)');\n}\n  // –û–ë–†–ê–ë–û–¢–ö–ê –¢–ï–ö–°–¢–ê (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞)\n  else if (message.text) {\n    contentData = message.text;\n    console.log('‚úÖ –¢–µ–∫—Å—Ç:', message.text.substring(0, 60) + '...');\n    \n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ URL (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞)\n    const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n    const urls = message.text.match(urlRegex);\n    if (urls && urls.length > 0) {\n      contentType = 'url';\n      isUrl = true;\n      console.log('üîó –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å—Å—ã–ª–∫–∞');\n    }\n  }\n  // –ï–°–õ–ò –ù–ò –í–ò–î–ï–û, –ù–ò –¢–ï–ö–°–¢ - –ü–†–û–ë–£–ï–ú –î–†–£–ì–ò–ï –¢–ò–ü–´\n  else if (message.caption) {\n    // –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É —Ñ–æ—Ç–æ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞)\n    contentType = 'caption';\n    contentData = message.caption;\n    console.log('üìù –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—å:', message.caption.substring(0, 60) + '...');\n  }\n  else {\n    console.log('‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è. –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è:', Object.keys(message));\n    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏\n    return [];\n  }\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å–æ—Ö—Ä–∞–Ω—è—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É + –¥–æ–±–∞–≤–ª—è–µ–º videoInfo –µ—Å–ª–∏ –µ—Å—Ç—å)\n  const result = {\n    json: {\n      // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n      chatId: message.chat.id,\n      messageId: message.message_id,\n      updateId: firstResult.update_id,\n      \n      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ\n      userId: message.from.id,\n      username: message.from.username || '',\n      firstName: message.from.first_name,\n      lastName: message.from.last_name || '',\n      \n      // –ö–æ–Ω—Ç–µ–Ω—Ç\n      contentType: contentType,\n      contentData: contentData,\n      text: message.text || message.caption || contentData, // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∏–ª–∏ –ø–æ–¥–ø–∏—Å—å\n      isUrl: isUrl,\n      \n      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–¥–µ–æ (–µ—Å–ª–∏ –µ—Å—Ç—å)\n      videoInfo: videoInfo,\n      \n      // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ\n      timestamp: message.date,\n      success: true,\n      processedAt: new Date().toISOString()\n    }\n  };\n  \n  console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞–∫:', contentType.toUpperCase());\n  return [result];\n  \n} catch (error) {\n  console.error('üí• –û—à–∏–±–∫–∞ –≤ Code node:', error.message);\n  console.error('Stack:', error.stack);\n  return [];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        -96
      ],
      "id": "cbdf7d43-a58f-4698-9a6d-081937f74fc7",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "url": "={{ $json.videoUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1360,
        624
      ],
      "id": "08dbd6d1-cf50-451b-9818-2cba23791326",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "jsCode": "// –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è Code Node (–ø–æ—Å–ª–µ Switch 'url')\ntry {\n  const item = $input.first().json;\n  const videoUrl = item.contentData; // –¢–µ–ø–µ—Ä—å —ç—Ç–æ –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª\n  \n  console.log('üé¨ –ü–æ–ª—É—á–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª:', videoUrl);\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª\n  const videoExtensions = ['.mp4', '.avi', '.mov', '.mkv', '.webm', '.flv'];\n  const isVideoFile = videoExtensions.some(ext => \n    videoUrl.toLowerCase().includes(ext)\n  );\n  \n  if (!isVideoFile && !videoUrl.includes('dl=1') && !videoUrl.includes('download')) {\n    console.warn('‚ö†Ô∏è –°—Å—ã–ª–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω–∞ –ø—Ä—è–º–æ–π —Ñ–∞–π–ª. –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π.');\n  }\n  \n  return [{\n    json: {\n      ...item,\n      videoUrl: videoUrl,\n      isDirectVideoLink: true,\n      readyForDownload: true,\n      // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞\n    }\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Å—ã–ª–∫–∏:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message,\n      readyForDownload: false\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        832,
        544
      ],
      "id": "37730081-4aa9-4f5f-89d2-3695180e3598",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "jsCode": "try {\n  const item = $input.first().json;\n  const binaryData = $input.first().binary;\n  \n  if (!binaryData || !binaryData.data) {\n    throw new Error('–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç');\n  }\n  \n  console.log('‚úÖ –í–∏–¥–µ–æ—Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');\n  console.log('üìè –†–∞–∑–º–µ—Ä:', Math.round(binaryData.data.length / 1024 / 1024), 'MB');\n  console.log('üìÑ –ò–º—è —Ñ–∞–π–ª–∞:', binaryData.fileName || 'video.mp4');\n  console.log('üéûÔ∏è MIME —Ç–∏–ø:', binaryData.mimeType || 'video/mp4');\n  \n  return [{\n    json: {\n      ...item,\n      videoFileSize: Math.round(binaryData.data.length / 1024 / 1024) + ' MB',\n      videoFileName: binaryData.fileName || 'downloaded_video.mp4',\n      videoMimeType: binaryData.mimeType || 'video/mp4',\n      downloadSuccess: true,\n      downloadTimestamp: new Date().toISOString()\n    },\n    binary: binaryData\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      downloadSuccess: false,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1568,
        624
      ],
      "id": "ebfc1c89-bb88-4588-b9c3-2e88014f4c82",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://python-server:5000/extract_audio",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "video",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "dataAudio"
            }
          },
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1776,
        624
      ],
      "id": "93405483-f0e5-4f9f-a8ec-bd467b5c98ca",
      "name": "HTTP Request3"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://python-server:5000/generate_subtitles",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "audio",
              "inputDataFieldName": "dataAudio"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "dataSub"
            }
          },
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1984,
        624
      ],
      "id": "e5c107b8-ea74-450c-81bd-a14d69a85a73",
      "name": "HTTP Request4"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://python-server:5000/translate_subtitles",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "=subtitles",
              "inputDataFieldName": "=dataSub"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "dataTranslatedPubs"
            }
          },
          "timeout": 8000000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2192,
        624
      ],
      "id": "52d9f998-74d8-4cbc-a92f-f03c30438a18",
      "name": "HTTP Request5"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://python-server:5000//burn_subtitles",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "video",
              "inputDataFieldName": "data"
            },
            {
              "parameterType": "formBinaryData",
              "name": "subtitles",
              "inputDataFieldName": "dataTranslatedPubs"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "Final"
            }
          },
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2400,
        624
      ],
      "id": "17497efc-bf59-4832-9a8f-1bae6c4f0a6d",
      "name": "HTTP Request6"
    },
    {
      "parameters": {
        "operation": "sendVideo",
        "chatId": "={{ $('Code in JavaScript').item.json.chatId }}",
        "binaryData": true,
        "binaryPropertyName": "Final",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2608,
        624
      ],
      "id": "671f370f-3c33-42bf-8a67-7d45f348fac6",
      "name": "Send a video",
      "webhookId": "2e4226eb-68f0-45d7-a478-ea1fe06ee5fe",
      "credentials": {
        "telegramApi": {
          "id": "QzIF6bZyJDYUkwfr",
          "name": "Telegram account 2"
        }
      }
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $('Code in JavaScript').item.json.videoInfo.fileId }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1216,
        -272
      ],
      "id": "d2923ad3-5c33-4c84-829f-393ec3f0d545",
      "name": "Get a file",
      "webhookId": "a7917f45-0d1e-43e3-a2a3-3bfbca3e91bb",
      "credentials": {
        "telegramApi": {
          "id": "QzIF6bZyJDYUkwfr",
          "name": "Telegram account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "try {\n  const updates = $input.first().json?.result || [];\n  let lastId = 0;\n  \n  // –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π update_id\n  for (const update of updates) {\n    if (update.update_id > lastId) {\n      lastId = update.update_id;\n    }\n  }\n  \n  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞\n  if (lastId > 0) {\n    $vars.set(\"telegramOffset\", lastId + 1);\n    console.log(`‚úÖ Offset —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: ${lastId + 1}`);\n  }\n  \n  return $input.all();\n} catch(e) {\n  console.error('Error:', e);\n  return [];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -272,
        -496
      ],
      "id": "b32b4c38-1de8-4d92-af7e-1f2d6729a526",
      "name": "Code in JavaScript3"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get a file",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "HTTP Request4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request4": {
      "main": [
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "Send a video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a file": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b6d5ddff-c51e-47cf-a203-fd3b3ea7d80d",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "38d7237aaf4a7d5c8f32c4bdfa7161c3df25bf18d6d13ad5f4d1b3f7545ba21e"
  },
  "id": "ofwMkIV0cWtwhWyP",
  "tags": []
}